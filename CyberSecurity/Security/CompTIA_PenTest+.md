# CompTIA PenTest+

## Penetration Testing Methodology and Frameworks

The pentest methodology varies depending on the type of client and the target of the test.  
However, it usually covers the following stages :
- **Information gathering** : passive collection of publicly accessible information (OSINT and research, no scan)
- **Enumeration / Scanning** : active discovery of the target applications and services (port scan, vulnerability scan...)
- **Exploitation** : leveraging discovered vulnerabilities to gain access (public or custom exploits)
- **Privilege escalation** : expand access to the target system (pivoting or gaining higher privileges)
- **Post-exploitation** : find what information are exposed after exploitation, cover tracks, report findings

Some frameworks provide guidelines for the penetration testing of some systems :


- **PTES** (Penetration Testing Execution Standard)  
  PTES is a framework to conduct thorough and effective penetration tests by defining 7 sections of a pentest :
  - **Pre-engagement interactions** : first communication and reasons to conduct the pentest
    - signing agreements
    - defining scope and timelines
    - lines of communication and emergency contacts
    - defining acceptable methods...
  - **Information gathering** : gathering information about the target
    - open-source intelligence
    - footprinting
  - **Threat modeling** : identify assets and processes that need protection, the threats and the capabilities
  - **Vulnerability analysis** : passive and active testing to identify vulnerabilities
  - **Exploitation** : actively exploiting the discovered vulnerabilities
  - **Post-exploitation** : accessing sensitive data, privilege escalation, backdoors installation...
  - **Reporting** : detailed report of all conducted activities, vulnerabilities, system accessed and potential impact  
  http://www.pentest-standard.org/index.php/Main_Page


- **CDPT Guidelines** (CREST Defensible Penetration Test)  
  CREST (Council of Registered Security Testers) is an organization of security companies setting rigorous standards for cybersecurity services.  
  Companies go through an extended audit and accreditation process to get CREST certified.  
  The CDPT guidelines are split into 10 sections.  
  https://www.crest-approved.org/wp-content/uploads/2022/12/CREST-Defensible-Penetration-Test-v5-2.pdf
  

- **OSSTMM** (Open Source Security Testing Methodology Manual) developed by ISECOM  
  Detailed framework of testing strategies for systems, software, applications, communication and human aspect.  
  It includes testing of telecommunications, and wired and wireless networks (128 pages).  
  It was not updated since 2010, but is still a relevant reference.  
  https://www.isecom.org/OSSTMM.3.pdf


- **OWASP Framework** (Open Web Application Security Project)  
  Community-driven framework to test the security of web applications and services.  
  It includes the OWASP Top 10 ranking of the most frequent vulnerabilities in websites and their remediation.  
  https://owasp.org/www-project-web-security-testing-guide/stable/


- **OWASP MASVS** (OWASP - Mobile Application Security Verification Standard)  
  MASVS sets baseline security standards to protect mobile applications.  
  It defines multiple control groups to divide the attack surface of mobile applications :  
    - MASVS-STORAGE : security of the sensitive data storage
    - MASVS-CRYPTO : centered on cryptographic measures
    - MASVS-AUTH : enforce strong mechanisms to verify identity and grant access rights
    - MASVS-NETWORK : security of network communication between the app and remote endpoints
    - MASVS-PLATFORM : interaction with the underlying mobile platform and other apps on the device
    - MASVS-CODE : secure development and maintenance of the app's code
    - MASVS-RESILIENCE : ability to resist reverse engineering and tampering attempts
    - MASVS-PRIVACY : enforce the implementation of privacy controls in compliance with privacy laws and regulations  
  https://github.com/OWASP/owasp-masvs


- **NIST CSF** (National Institute of Standards and Technology - Cybersecurity Framework)  
  Popular framework (50% of US organizations) used to improve an organization's cybersecurity standards and manage the risk of cyber-threats.  
  It provides guidelines on security controls and benchmarks.  
  https://www.nist.gov/cyberframework  
  The NIST also offers some special publications :  
  - **SP 800-171** : Protected Controlled Unclassified Information in Non-Federal Systems and Organizations
  - **SP 800-53** : Security and Privacy Controls for Information Systems and Organizations (500 pages, list controls that should be in place)


- **NCSC CAF** (National Cyber Security Centre - Cyber Assessment Framework)  
  Extensive framework of 14 principles to assess the risk of cyber threat and how to defend against these threats.  
  https://www.ncsc.gov.uk/collection/cyber-assessment-framework/caf-objective-a-managing-security-risk


- **MITRE ATT&CK** (Adversary Tactics, Techniques & Common Knowledge)  
  Detailed playbook of different ways attackers can attack a system.  
  Developed to improve the understanding of threat behaviors and defend against them.  
  It is a catalog of tactics (initial access, execution, persistence, privilege escalation, defense evasion...).  
  Each tactic is further divided into specific techniques, for example initial access can be achieved by spear phishing, drive-by compromise...  
  https://attack.mitre.org


- **ISSAF** (Information Systems Security Assessment Framework)  
  Open-source resource providing a comprehensive security assessment framework (1264 pages).  
  It stopped receiving updated in 2006, so it is deprecated and not in the PenTest+ objective from version PT0-003.  
  Other penetration testing frameworks like OSSTMM, OWASP or PTES should be used instead.


- **STRIDE** : security model developed by Microsoft for software development and cybersecurity
  - **Spoofing** : assume the identity of another user to gain unauthorized access to data or systems
  - **Tampering** : malicious alteration of data
  - **Repudiation** : actions that cannot be traced back to an individual user
  - **Information Disclosure** : unauthorized access to confidential information 
  - **Denial of Service** : overwhelm the system to disrupt normal activity for legitimate users
  - **Elevation of Privilege** : limited user gaining higher permission over the system


- **Purdue Model for ICS (Industrial Control System)** : framework to protect OT environments (Operational Technology)
  - define network segmentation to isolate and protect OT systems from cyber threats
  - defines 7 zones :
    - Level 5 - External / Vendor Support / Cloud Access
    - Level 4 - Business Logistics Systems / Enterprise IT Level
    - Level 3.5 - Demilitarized Zone (control exchange of data between IT and OT systems with firewalls and proxies)
    - Level 3 - Manufacturing Operations System Zone
    - Level 2 - Control System Zone (include SCADA systems to control physical processes)
    - Level 1 - Intelligent Devices Zone (include PLCs)
    - Level 0 - Physical Process Zone (include sensors)


- **OCTAVE** (Operationnally Critical Threat, Asset and Vulnerability Evaluation)  
  - framework designed to manage organizational risks
  - beneficial for small to medium-size organizations without large dedicated security teams
  - encourage organizations to take ownership of the security strategies instead of relying on external consultants
  - emphasize protecting critical assets based on their value to the organization
  - include 3 phases split into 8 processes


- **DREAD** : Risk assessment model to quantify and prioritize the level of risk from several security threats  
  Each threat is assigned a score between 0 and 10 for each of the 5 DREAD categories.  
  The total threat score defines its severity : Low (0-10) / Medium (11-24) / High (25-39) / Critical (40-50)
    - **Damage Potential** : how much damage can a successful exploitation cause ?
    - **Reproducibility** : how easily the threat can be replicated by an attacker ?
    - **Exploitability** : how much effort is required to exploit the vulnerability ?
    - **Affected Users** : what users are impacted in a successful exploitation ?
    - **Discoverability** : how easy can the vulnerability be discovered by an attacker ?


### Regulations

Some companies request a penetration test as part of the compliance to some regulations.  
The penetration test must focus on these regulations' requirements to test the company's compliance.  

- **GDPR** (General Data Protection Regulation)  
GDPR imposes strict rules on data processing and storage within the EU and for business dealing with EU citizens' data.  
It requires explicit permission for data processing, and it requires a data protection officer in the company.  


- **GLBA** (Gramm-Leach-Bliley Act)  
GLBA protects the privacy of individuals' financial information held by financial institutions.


- **HIPAA** (Health Insurance Portability and Accountability Act)  
HIPAA regulates the confidentiality and security of healthcare information in the US.  
It requires patient data encryption, the implementation of secure access control and regular audits.  


- **PCI-DSS** (Payment Card Industry - Data Security Standard)  
PCI-DSS is not a regulation, but a standard agreed upon by the major actors of the payment card industry.  
It requires a secure network, strong access controls and regular network monitoring ad testing.


- **ISO/IEC 27000 Series**  
These standards are not legally mandatory, but they are highly recommended for organization handling sensitive data.  
They provide specifications for implementing, maintaining and improving information security management systems (ISMS).  
Many organizations want ISO/IEC 27000 certification to demonstrate strong security practices.  
Many vendors also want this certification as it is a main selection criteria for their customers.  
 

## Pre-engagement Activities

These are the tasks that need to be completed before the beginning of a penetration test. 

### Type of assessment
- **network** : evaluate the security of the entire network, both hardware and software (routers, switches, firewalls...)
  - network topology
  - firewall configuration
  - security policies
- **wireless** : focus on security assessment of wireless networks
- **application** : target a specific application, either developed in-house of by a 3rd party (code, dependencies, configuration)
  - usually performed before the application deployment
  - check compliance with relevant security standards
- **mobile** : focused on mobile applications and platform
  - data leakage
  - improper session handling
  - insecure data storage
- **web** : securing a web application (SQLi, XSS, security misconfiguration...)
- **cloud** : security posture of cloud-based services and infrastructure (AWS, Azure, GCP)
- **API** : test APIs used for the integration between systems and services


### Legal Agreements

- **NDA** (Non-Disclosure Agreements) : legally binding contract establishing a confidential relationship between the involved parties

- **MSA** (Master Service Agreement) : foundational terms of the business relationship between the service provider and the client
  - project scope
  - payment details
  - confidentiality clauses
  - liability issues

- **SoW** (Statement of Work) : specifics of the project or service provided (objectives, deliverables, scope, timelines, payment schedules...)

- **ToS** (Terms of Service) : govern the use of the service provided by the PenTest firm 
  - specify tools to use
  - specify limitations (no reverse-engineering...)

- **SLA** (Service Level Agreement) : commitment from the service provider for a specific quality of service (availability, responsibilities, permitted pentests...)


### Legal and Ethical Considerations

- **Authorization letters** : formally granting permission to the penetration testing team to conduct simulated cyber-attacks against the system
  - detailed scope (networks, hosts, applications), validity period, allowed techniques
  - testing on cloud provider infrastructure requires to contact the cloud vendor, for ex AWS has a specific policy for penetration testing

- **Mandatory reporting** : dictate how and when findings must be disclosed

- **Escalation path** : clearly estabish the chain of command and communication protocols in case of issue (unstable system, prod system impacted, breach of data...)

- **Export Restriction** : some technologies are not allowed to be exported outside of the US, mostly around encryption

- **National and local restriction** : some countries have specific regulations and customs that must be followed

- **Corporate Policies** : specific rules for the client organization


### Rules of Engagement

Rules of Engagement are guidelines to ensure the testing team and the client are in line with the way the tests are conducted.
- **Exclusions** : areas in the pentest that are off-limits , due to data sensitivity, business disruption or other constraints
- **Test Cases** : types of tests that will be conducted, like SQLi, password cracking, ...
- **Testing Window**
- **Goal Reprioritization** : change in test's priorities as the pentest progresses and vulnerabilities are found


### Shared Responsibility Model

The shared responsibility model defines the role of each party in maintaining the security of the system :
- **hosting providers** : secure the infrastructure that runs the service offered to customers
- **customer** : secure the data and applications running on the infrastructure  
- **penetration testers** : sort of external auditors, finding vulnerabilities that threat actors could exploit
- **3rd party application vendor** : secure the data within the 3rd party application


## Reporting

- Create a clear executive summary with business impact (understandable by non-tech management people)
- Detail the scope and methodology
- Present findings and evidence
- Prioritize vulnerabilities (critical / high / medium / low)
- Provide actionable recommendations
- Assess the overall security posture
- Include any limitation (off-limit hours / machines / methods...)